scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 19:15:00"), yend = 2000)+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 19:15:00"), yend = 6000)+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 19:15:00"), yend = 5990)+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 19:35:00"), yend = 5990)+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 19:35:00"), yend = 5990,curvature = curv)+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 19:35:00"), yend = 5990,arrow = arrow(length = unit(1.5, "mm")))+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = 8000, yend = 5990,arrow = arrow(length = unit(1.5, "mm")))+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 18:35:00"), yend = 5990,arrow = arrow(length = unit(1.5, "mm")))+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`))+
#geom_line(mapping = aes(x = dtm, y = cumulative))+
geom_point(x = news_alert, y = new1$`Online Applications`[234], colour = "red", size = 4)+
annotate("text",label="Apple News\nnotification",x = news_alert, y = new1$`Online Applications`[234], vjust = -0.5)+
geom_point(x = jezza_tweet,y = new1$`Online Applications`[205], colour = "blue", size = 4)+
geom_point(x = tiktok_alert, y = new1$`Online Applications`[144],colour = "green", size = 4)+
geom_point(x = c4debate, y = new1$`Online Applications`[228], colour = "yellow", size = 4)+
annotate("curve",x = news_alert, y = new1$`Online Applications`[228], xend = dmy_hms("18/06/2024 19:35:00"), yend = 5990,arrow = arrow(length = unit(1.5, "mm")))+
geom_point(x = skynews, y = new1$`Online Applications`[224],colour = "orange", size = 4)+
annotate("text",label="Sky News\narticle",x = skynews, y = new1$`Online Applications`[224], vjust = -0.5)+
annotate("text",label="TikTok\nnotification",x = tiktok_alert, y = new1$`Online Applications`[144], vjust = -0.5)+
annotate("text",label="Jeremy Corbyn\ntweet",x = jezza_tweet, y = new1$`Online Applications`[205], vjust = -0.5)+
scale_x_datetime(breaks = "3 hours", date_labels = "%H:%M")+
#scale_y_continuous(sec.axis = sec_axis(~. * 300))+
theme_minimal()
jj
#| echo: false
#| fig-show: asis
library(zoo)
title_text2   <- str_glue("Voter registration for 2024 & 2019 elections")
subtitle_text2 <- glue("The trends in registrations are very similar")
daily_2024 <- read_csv("Register_To_Vote_applications_breakdown_01_04_2024_to_18_06_2024.csv",
col_types = cols(`Paper forms` = col_skip()), show_col_types = FALSE)
daily_2024$Date <- dmy(daily_2024$Date)
daily_2024 <- daily_2024 |> filter(Date>="2024-05-22") |> arrange(Date)
daily_2024$index <- 1:nrow(daily_2024)
daily_2024 <- daily_2024 |>
mutate(moving_avg = rollmean(Online, k=3, fill = NA, align = "right"))
daily_2019 <- read_csv("Register_To_Vote_applications_breakdown_04_09_2019_to_12_12_2019.csv",show_col_types = FALSE)
daily_2019$Date <- dmy(daily_2019$Date)
daily_2019 <- daily_2019 |> filter(Date>="2019-10-29" & Date<="2019-11-26") |> arrange(Date)
daily_2019$index <- 1:nrow(daily_2019)
daily_2019 <- daily_2019 |>
mutate(moving_avg = rollmean(Online, k=3, fill = NA, align = "right"))
ggplot()+
geom_line(daily_2019, mapping = aes(x = index, y = Online), colour = "#3F88C5")+
#geom_line(linetype = 2,daily_2019, mapping = aes(x = index, y = moving_avg), colour = "blue")+
geom_line(daily_2024, mapping = aes(x = index, y = Online), colour = "#D00000")+
#geom_line(linetype = 2,daily_2024, mapping = aes(x = index, y = moving_avg), colour = "red")
scale_x_continuous(breaks = seq(1,29, by =1))+
theme_fivethirtyeight()+
labs(x = "Days of election campaign",
y = "Number of applications submitted",
title = title_text2,
subtitle = subtitle_text2,
caption = caption_text)+
theme(
legend.position = "off",
axis.title.x.top = element_markdown(
margin = margin(10, 2, 10, 2),
size   = rel(.9),
color  = text_col,
family        = "Futura",
face   = "bold"
),
legend.title = element_markdown(
size   = rel(.9),
hjust  = 0.5,
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.text = element_text(
size   = rel(.7),
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.key.height  = unit(.8, "cm"),
#legend.margin    = margin(t = 5, b = -5, unit = "pt"), #size of the box
plot.title      = element_text(
size          = rel(1),
family        = "Futura",
face          = "bold",
color         = title_col,
lineheight    = 1.1,
margin        = margin(t = 5, b = 3)
),
plot.subtitle   = element_textbox_simple(
size          = rel(0.8),
family        = "Futura",
color         = subtitle_col,
lineheight    = -0.4,
margin        = margin(t = 2, b = 8)
),
plot.caption    = element_textbox_simple(family = "Futura",size = 7,margin = margin(2, 0, 0, 0, "lines")),
axis.text  = element_text(size = rel(.5),family        = "Futura"),
axis.title.x  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = -5),
axis.title.y  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = 2),
panel.grid.major = element_blank(),
panel.grid.major.y = element_line(colour = "#ced4da", linewidth = 0.5))
#| echo: false
#| fig-show: asis
library(zoo)
title_text2   <- str_glue("Voter registration for 2024 & 2019 elections")
subtitle_text2 <- glue("The trends in registrations are very similar")
daily_2024 <- read_csv("Register_To_Vote_applications_breakdown_01_04_2024_to_18_06_2024.csv",
col_types = cols(`Paper forms` = col_skip()), show_col_types = FALSE)
daily_2024$Date <- dmy(daily_2024$Date)
daily_2024 <- daily_2024 |> filter(Date>="2024-05-22") |> arrange(Date)
daily_2024$index <- 1:nrow(daily_2024)
daily_2024 <- daily_2024 |>
mutate(moving_avg = rollmean(Online, k=3, fill = NA, align = "right"))
daily_2019 <- read_csv("Register_To_Vote_applications_breakdown_04_09_2019_to_12_12_2019.csv",show_col_types = FALSE)
daily_2019$Date <- dmy(daily_2019$Date)
daily_2019 <- daily_2019 |> filter(Date>="2019-10-29" & Date<="2019-11-26") |> arrange(Date)
daily_2019$index <- 1:nrow(daily_2019)
daily_2019 <- daily_2019 |>
mutate(moving_avg = rollmean(Online, k=3, fill = NA, align = "right"))
ggplot()+
geom_line(daily_2019, mapping = aes(x = index, y = Online), colour = "#3F88C5")+
#geom_line(linetype = 2,daily_2019, mapping = aes(x = index, y = moving_avg), colour = "blue")+
geom_line(daily_2024, mapping = aes(x = index, y = Online), colour = "#D00000")+
#geom_line(linetype = 2,daily_2024, mapping = aes(x = index, y = moving_avg), colour = "red")
scale_x_continuous(breaks = seq(1,29, by =1))+
theme_fivethirtyeight()+
labs(x = "Days of election campaign",
y = "Number of applications submitted",
title = title_text2,
subtitle = subtitle_text2,
caption = caption_text)+
theme(
legend.position = "off",
axis.title.x.top = element_markdown(
margin = margin(10, 2, 10, 2),
size   = rel(.9),
color  = text_col,
family        = "Futura",
face   = "bold"
),
legend.title = element_markdown(
size   = rel(.9),
hjust  = 0.5,
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.text = element_text(
size   = rel(.7),
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.key.height  = unit(.8, "cm"),
#legend.margin    = margin(t = 5, b = -5, unit = "pt"), #size of the box
plot.title      = element_text(
size          = rel(1),
family        = "Futura",
face          = "bold",
color         = title_col,
lineheight    = 1.1,
margin        = margin(t = 5, b = 3)
),
plot.subtitle   = element_textbox_simple(
size          = rel(0.8),
family        = "Futura",
color         = subtitle_col,
lineheight    = -0.4,
margin        = margin(t = 2, b = 8)
),
plot.caption    = element_textbox_simple(family = "Futura",size = 7,margin = margin(2, 0, 0, 0, "lines")),
axis.text  = element_text(size = rel(.5),family        = "Futura"),
axis.title.x  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = -5),
axis.title.y  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = 2),
panel.grid.major = element_blank(),
panel.grid.major.y = element_line(colour = "#ced4da", linewidth = 0.5))
#| echo: false
#| fig-show: asis
library(tidyverse)
library(readr)
library(ggthemes)
library(ggtext)
library(glue)
tt <- str_glue("Data: Department for Levelling Up, Housing, and Communities<br>")
title_text   <- str_glue("Voter registration - June 18 2024")
subtitle_text <- glue("Fluctuations in applications over 5-minute intervals on the final day of registration")
bs <- str_glue("<span style='font-family:\"Font Awesome 6 Brands\"'>&#xe671;</span>")
gh <- str_glue("<span style='font-family:\"Font Awesome 6 Brands\"'>&#xf09b;</span>")
tw <- str_glue("<span style='font-family:\"Font Awesome 6 Brands\"'>&#xe61a;</span>")
caption_text <- glue("{tt} {bs} tangandhara.bsky.social &bull; {gh} tangandhara &bull; {tw} tangandhara")
bkg_col      <- colorspace::lighten('#343a40', 0.2)
title_col    <- "#000000"
subtitle_col <- "#000000"
caption_col  <- "#000000"
text_col     <- colorspace::darken("#eeeeee" , 0.15)
vote_june18 <- read_csv("Register_To_Vote_live_usage_18_Jun_2024.csv", show_col_types = FALSE)
new1 <- vote_june18 |>
mutate(date = if_else(`Online Applications`== "879", "19/06/2024", "18/06/2024"))
new1 <- new1 %>%
mutate(dtm = dmy_hms(str_c(date, " ", Time)))
new1 <- new1 |> arrange(dtm)
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = `Online Applications`), colour = "#3F88C5")+
scale_x_datetime(breaks = "2 hours", date_labels = "%H:%M")+
theme_fivethirtyeight()+
labs(x = "Time",
y = "Number of applications submitted",
title = title_text,
subtitle = subtitle_text,
caption = caption_text)+
theme(
legend.position = "off",
axis.title.x.top = element_markdown(
margin = margin(10, 2, 10, 2),
size   = rel(.9),
color  = text_col,
family        = "Futura",
face   = "bold"
),
legend.title = element_markdown(
size   = rel(.9),
hjust  = 0.5,
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.text = element_text(
size   = rel(.7),
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.key.height  = unit(.8, "cm"),
#legend.margin    = margin(t = 5, b = -5, unit = "pt"), #size of the box
plot.title      = element_text(
size          = rel(1),
family        = "Futura",
face          = "bold",
color         = title_col,
lineheight    = 1.1,
margin        = margin(t = 5, b = 3)
),
plot.subtitle   = element_textbox_simple(
size          = rel(0.8),
family        = "Futura",
color         = subtitle_col,
lineheight    = -0.4,
margin        = margin(t = 2, b = 8)
),
plot.caption    = element_textbox_simple(family = "Futura",size = 7,margin = margin(2, 0, 0, 0, "lines")),
axis.text  = element_text(size = rel(.5),family        = "Futura"),
axis.title.x  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = -5),
axis.title.y  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = 2),
panel.grid.major = element_blank(),
panel.grid.minor.x = element_line(colour = "#ced4da", linewidth = 0.5))
#| echo: false
#| fig-show: asis
title_text1   <- str_glue("Cumulative voter registration - June 18 2024")
subtitle_text1 <- glue("There were approximately 630K applications to register to vote on the final day of registration")
new1 <- new1 |>
mutate(cumulative = cumsum(`Online Applications`))
new1 |> ggplot()+
geom_line(lineend = "round",mapping = aes(x = dtm, y = cumulative), colour = "#3F88C5")+
scale_x_datetime(breaks = "2 hours", date_labels = "%H:%M")+
theme_fivethirtyeight()+
labs(x = "Time",
y = "Number of applications submitted",
title = title_text1,
subtitle = subtitle_text1,
caption = caption_text)+
theme(
legend.position = "off",
axis.title.x.top = element_markdown(
margin = margin(10, 2, 10, 2),
size   = rel(.9),
color  = text_col,
family        = "Futura",
face   = "bold"
),
legend.title = element_markdown(
size   = rel(.9),
hjust  = 0.5,
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.text = element_text(
size   = rel(.7),
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.key.height  = unit(.8, "cm"),
#legend.margin    = margin(t = 5, b = -5, unit = "pt"), #size of the box
plot.title      = element_text(
size          = rel(1),
family        = "Futura",
face          = "bold",
color         = title_col,
lineheight    = 1.1,
margin        = margin(t = 5, b = 3)
),
plot.subtitle   = element_textbox_simple(
size          = rel(0.8),
family        = "Futura",
color         = subtitle_col,
lineheight    = -0.4,
margin        = margin(t = 2, b = 8)
),
plot.caption    = element_textbox_simple(family = "Futura",size = 7,margin = margin(2, 0, 0, 0, "lines")),
axis.text  = element_text(size = rel(.5),family        = "Futura"),
axis.title.x  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = -5),
axis.title.y  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = 2),
panel.grid.major = element_blank(),
panel.grid.minor.x = element_line(colour = "#ced4da", linewidth = 0.5))
#| echo: false
#| fig-show: asis
library(zoo)
title_text2   <- str_glue("Voter registration for 2024 & 2019 elections")
subtitle_text2 <- glue("The trends in registrations are very similar")
daily_2024 <- read_csv("Register_To_Vote_applications_breakdown_01_04_2024_to_18_06_2024.csv",
col_types = cols(`Paper forms` = col_skip()), show_col_types = FALSE)
daily_2024$Date <- dmy(daily_2024$Date)
daily_2024 <- daily_2024 |> filter(Date>="2024-05-22") |> arrange(Date)
daily_2024$index <- 1:nrow(daily_2024)
daily_2024 <- daily_2024 |>
mutate(moving_avg = rollmean(Online, k=3, fill = NA, align = "right"))
daily_2019 <- read_csv("Register_To_Vote_applications_breakdown_04_09_2019_to_12_12_2019.csv",show_col_types = FALSE)
daily_2019$Date <- dmy(daily_2019$Date)
daily_2019 <- daily_2019 |> filter(Date>="2019-10-29" & Date<="2019-11-26") |> arrange(Date)
daily_2019$index <- 1:nrow(daily_2019)
daily_2019 <- daily_2019 |>
mutate(moving_avg = rollmean(Online, k=3, fill = NA, align = "right"))
ggplot()+
geom_line(daily_2019, mapping = aes(x = index, y = Online), colour = "#3F88C5")+
#geom_line(linetype = 2,daily_2019, mapping = aes(x = index, y = moving_avg), colour = "blue")+
geom_line(daily_2024, mapping = aes(x = index, y = Online), colour = "#D00000")+
#geom_line(linetype = 2,daily_2024, mapping = aes(x = index, y = moving_avg), colour = "red")
scale_x_continuous(breaks = seq(1,29, by =1))+
theme_fivethirtyeight()+
labs(x = "Days of election campaign",
y = "Number of applications submitted",
title = title_text2,
subtitle = subtitle_text2,
caption = caption_text)+
theme(
legend.position = "off",
axis.title.x.top = element_markdown(
margin = margin(10, 2, 10, 2),
size   = rel(.9),
color  = text_col,
family        = "Futura",
face   = "bold"
),
legend.title = element_markdown(
size   = rel(.9),
hjust  = 0.5,
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.text = element_text(
size   = rel(.7),
family        = "Futura",
face   = "bold",
color  = text_col
),
legend.key.height  = unit(.8, "cm"),
#legend.margin    = margin(t = 5, b = -5, unit = "pt"), #size of the box
plot.title      = element_text(
size          = rel(1),
family        = "Futura",
face          = "bold",
color         = title_col,
lineheight    = 1.1,
margin        = margin(t = 5, b = 3)
),
plot.subtitle   = element_textbox_simple(
size          = rel(0.8),
family        = "Futura",
color         = subtitle_col,
lineheight    = -0.4,
margin        = margin(t = 2, b = 8)
),
plot.caption    = element_textbox_simple(family = "Futura",size = 7,margin = margin(2, 0, 0, 0, "lines")),
axis.text  = element_text(size = rel(.5),family        = "Futura"),
axis.title.x  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = -5),
axis.title.y  = element_text(size = rel(0.5),family        = "Futura",face="bold", hjust = 0.5, vjust = 2),
panel.grid.major = element_blank(),
panel.grid.major.y = element_line(colour = "#ced4da", linewidth = 0.5))
